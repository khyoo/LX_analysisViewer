<script type="text/javascript">

  var roadPOISource2 = new ol.source.Vector({
    url: 'http://info.rlog.kr:8880/rest/shp2Geojson/jeonju_road_poi_all',
    projection: 'EPSG:3857',
    format: new ol.format.GeoJSON()
  });

  roadPOISource2.on('featuresloadstart', function (e) {
    $('#div_load_image').show();
  });

  roadPOISource2.on('featuresloadend', function (e) {
    $('#div_load_image').hide();
    if (roadPOISource2.getState() === 'ready') {
      // TO-DO         
    }
  });

  var roadPOIVector2 = new ol.layer.Vector({
    visible: false,
    source: roadPOISource2,
    style: new ol.style.Style({
      image: new ol.style.Circle({
        radius: 5,
        snapToPixel: false,
        stroke: new ol.style.Stroke({
          //color: "#6C757D",
          color: "#900",
          width: 2
        })
      })
    }),
    maxResolution: 25,
    zIndex: 1000
  });
  map.addLayer(roadPOIVector2);

  $('#allRoadPoiChk').on('click', function () {
    if (roadPOIVector2.getVisible()) {
      roadPOIVector2.setVisible(false);
    } else {
      roadPOIVector2.setVisible(true);
    }
  });

  map.addLayer(roadPOIVector);
  map.addLayer(roadPOIVector_matcher);
  map.addLayer(hmapVector);

  $('#psLayerChk').on('click', function () {
    if ($('#psLayerChk').is(':checked')) {
      $('#psPointChk').prop('checked', true);
      roadPOIVector.setVisible(true);
      roadPOILabelVector.setVisible(true);

      $('#psHmapChk').prop('checked', true);
      $('#psHmapScoreChk').prop('checked', true);
      $('.psPointDiv').css('display', 'inline');
      hmapVector.setVisible(true);
      $('.hmapDiv1').show();
    } else {
      $('#psPointChk').prop('checked', false);
      roadPOIVector.setVisible(false);
      roadPOILabelVector.setVisible(false);

      $('#psHmapChk').prop('checked', false);
      $('#psHmapScoreChk').prop('checked', false);
      $('.psPointDiv').css('display', 'none');
      hmapVector.setVisible(false);
      $('.hmapDiv1').hide();
    }
  });

  $('#psPointChk').on('click', function () {
    if (roadPOIVector.getVisible()) {
      roadPOIVector.setVisible(false);
      roadPOILabelVector.setVisible(false);

      $('#psHmapScoreChk').prop('checked', false);
      $('.psPointDiv').css('display', 'none');
    } else {
      roadPOIVector.setVisible(true);
      roadPOILabelVector.setVisible(true);

      $('#psHmapScoreChk').prop('checked', true);
      $('.psPointDiv').css('display', 'inline');
    }
  });

  $('#psPointMatcherChk').on('click', function () {
    if (roadPOIVector_matcher.getVisible()) {
      roadPOIVector_matcher.setVisible(false);

      $('.psPointDiv2').css('display', 'none');
    } else {
      roadPOIVector_matcher.setVisible(true);

      $('.psPointDiv2').css('display', 'inline');
    }
  });

  $('#psHmapChk').on('click', function () {
    if (hmapVector.getVisible()) {
      hmapVector.setVisible(false);
      $('.hmapDiv1').hide();
    } else {
      hmapVector.setVisible(true);
      $('.hmapDiv1').show();
    }
  });

  map.addLayer(roadPOILabelVector);
  $('#psHmapScoreChk').on('click', function () {
    if (roadPOILabelVector.getVisible()) {
      roadPOILabelVector.setVisible(false);
    } else {
      roadPOILabelVector.setVisible(true);
    }
  });


  map.addLayer(flowlineVector);

  $('#psLayerChk2').on('click', function () {
    if ($('#psLayerChk2').is(':checked')) {
      $('#psHmapChk2').prop('checked', true);
      $('.psLineDiv').css('display', 'inline');
      flowlineVector.setVisible(true);
      $('.hmapDiv2').show();
      $('.psItems').show();
    } else {
      $('#psHmapChk2').prop('checked', false);
      $('.psLineDiv').css('display', 'none');
      flowlineVector.setVisible(false);
      $('.hmapDiv2').hide();
      $('.psItems').hide();
    }
  });

  $('#psHmapChk2').on('click', function () {
    if (flowlineVector.getVisible()) {
      flowlineVector.setVisible(false);
      $('.hmapDiv2').hide();
    } else {
      flowlineVector.setVisible(true);
      $('.hmapDiv2').show();
    }
  });

  $('#psHmapChk3').on('click', function () {
    if (!$('#psHmapChk3').is(':checked')) {
      $('.hmapDiv3').hide();
    } else {
      $('.hmapDiv3').show();
    }
  });


  $('#psObst_levelChk').on('click', function () {
    if (!$('#psObst_levelChk').is(':checked')) {
      $('.hmapSubDiv1').hide();
    } else {
      $('.hmapSubDiv1').show();
    }
  });

  $('#psSf_levelChk').on('click', function () {
    if (!$('#psSf_levelChk').is(':checked')) {
      $('.hmapSubDiv2').hide();
    } else {
      $('.hmapSubDiv2').show();
    }
  });

  $('#psSr_levelChk').on('click', function () {
    if (!$('#psSr_levelChk').is(':checked')) {
      $('.hmapSubDiv3').hide();
    } else {
      $('.hmapSubDiv3').show();
    }
  });

  $('#psSlop_levelChk').on('click', function () {
    if (!$('#psSlop_levelChk').is(':checked')) {
      $('.hmapSubDiv4').hide();
    } else {
      $('.hmapSubDiv4').show();
    }
  });

  $('#psSky_levelChk').on('click', function () {
    if (!$('#psSky_levelChk').is(':checked')) {
      $('.hmapSubDiv5').hide();
    } else {
      $('.hmapSubDiv5').show();
    }
  });

  $('#psTree_levelChk').on('click', function () {
    if (!$('#psTree_levelChk').is(':checked')) {
      $('.hmapSubDiv6').hide();
    } else {
      $('.hmapSubDiv6').show();
    }
  });

  $('#psPoi_levelChk').on('click', function () {
    if (!$('#psPoi_levelChk').is(':checked')) {
      $('.hmapSubDiv7').hide();
    } else {
      $('.hmapSubDiv7').show();
    }
  });

  $('#psBus_levelChk').on('click', function () {
    if (!$('#psBus_levelChk').is(':checked')) {
      $('.hmapSubDiv8').hide();
    } else {
      $('.hmapSubDiv8').show();
    }
  });


  $('#save1').on('click', function (e) {
    alert('준비 중입니다.');
  });

  $('#down1').on('click', function (e) {
    var geojson = new ol.format.GeoJSON().writeFeatures(roadPOISource.getFeatures());
    // console.log(geojson);
    var filename = 'poi.geojson';

    var createUrl = '/download/create';
    var downloadUrl = '/download';

    $.ajax({
      type: "POST",
      url: createUrl,
      data: {
        filename: filename,
        source: geojson
      },
      dataType: "json",
      beforeSend: function () {
        $('#div_load_image').show();
      },
      success: function (data) {
        $('#div_load_image').hide();

        location.href = downloadUrl + '/' + filename;
      },
      error: function () {
        alert('에러가 발생했습니다.');
      }
    });
  });

  $('#save2').on('click', function (e) {
    alert('준비 중입니다.');
  });

  $('#down2').on('click', function (e) {
    var geojson = new ol.format.GeoJSON().writeFeatures(flowlineSource.getFeatures());
    // console.log(geojson);
    var filename = 'line.geojson';

    var createUrl = '/download/create';
    var downloadUrl = '/download';

    $.ajax({
      type: "POST",
      url: createUrl,
      data: {
        filename: filename,
        source: geojson
      },
      dataType: "json",
      beforeSend: function () {
        $('#div_load_image').show();
      },
      success: function (data) {
        $('#div_load_image').hide();

        location.href = downloadUrl + '/' + filename;
      },
      error: function () {
        alert('에러가 발생했습니다.');
      }
    });
  });
</script>