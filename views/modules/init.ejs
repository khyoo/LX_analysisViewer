<script type="text/javascript">

// var vectorSource22 = new ol.source.Vector({
//   projection: 'EPSG:3857',
//   format: new ol.format.GeoJSON(),
//   loader: function(extent, resolution, projection) {
//      var proj = projection.getCode();
//      var url = 'http://info.rlog.kr:8880/rest/shp2Geojson/jeonju_road_poi_all';
//      var xhr = new XMLHttpRequest();
//      xhr.open('GET', url);
//      var onError = function() {
//       vectorSource22.removeLoadedExtent(extent);
//      }
//      xhr.onerror = onError;
//      xhr.onload = function() {
//        if (xhr.status == 200) { //console.log(xhr.responseText);
//         vectorSource22.addFeatures(
//           vectorSource22.getFormat().readFeatures(xhr.responseText));

//           var roadPOIVector2 = new ol.layer.Vector({
//         title: '도로 Point2',
//         visible: true,
//         source: vectorSource22,
//         style: new ol.style.Style({
//           image: new ol.style.Circle({
//             radius: 5,
//             snapToPixel: false,
//             stroke: new ol.style.Stroke({
//               //color: "#6C757D",
//               color: "#900",
//               width: 2
//             })
//           })
//         }),
//         maxResolution: 25,
//         zIndex: 1000
//       });
//       map.addLayer(roadPOIVector2);
//       console.log(roadPOIVector2);
//        } else {
//          onError();
//        }
//      }
//      xhr.send();
//    },
//    //strategy: bbox
//  });

      var roadPOISource2 = new ol.source.Vector({        
        url: 'http://info.rlog.kr:8880/rest/shp2Geojson/jeonju_road_poi_all',
        projection: 'EPSG:3857',
        format: new ol.format.GeoJSON()
      });

      roadPOISource2.on('featuresloadstart', function (e) {        
        $('#div_load_image').show();       
      });

      roadPOISource2.on('featuresloadend', function (e) {        
        $('#div_load_image').hide();
        if (roadPOISource2.getState() === 'ready') {
          // TO-DO
         
        }
      });

      var roadPOIVector2 = new ol.layer.Vector({        
        visible: false,
        source: roadPOISource2,
        style: new ol.style.Style({
          image: new ol.style.Circle({
            radius: 5,
            snapToPixel: false,
            stroke: new ol.style.Stroke({
              //color: "#6C757D",
              color: "#900",
              width: 2
            })
          })
        }),
        maxResolution: 25,
        zIndex: 1000
      });
      map.addLayer(roadPOIVector2);

      $('#allRoadPoiChk').on('click', function () {
        if (roadPOIVector2.getVisible()) {
          roadPOIVector2.setVisible(false);          
        } else {
          roadPOIVector2.setVisible(true);
        }      
      });

      map.addLayer(roadPOIVector);
      map.addLayer(hmapVector);

      $('#psLayerChk').on('click', function () {
        if($('#psLayerChk').is(':checked')) {
          $('#psPointChk').prop('checked', true);
          roadPOIVector.setVisible(true);

          $('#psHmapChk').prop('checked', true);
          hmapVector.setVisible(true);
          $('.hmapDiv1').show();
        } else {
          $('#psPointChk').prop('checked', false);
          roadPOIVector.setVisible(false);

          $('#psHmapChk').prop('checked', false);
          hmapVector.setVisible(false);
          $('.hmapDiv1').hide();
        }
      });

      $('#psPointChk').on('click', function () {
        if (roadPOIVector.getVisible()) {
          roadPOIVector.setVisible(false);
        } else {
          roadPOIVector.setVisible(true);
        }      
      });
      
      $('#psHmapChk').on('click', function () {
        if (hmapVector.getVisible()) {          
          hmapVector.setVisible(false);
          $('.hmapDiv1').hide();
        } else {          
          hmapVector.setVisible(true);
          $('.hmapDiv1').show();
        }      
      });

      map.addLayer(roadPOILabelVector);
      $('#psHmapScoreChk').on('click', function () {
        if (roadPOILabelVector.getVisible()) {
          roadPOILabelVector.setVisible(false);
        } else {
          roadPOILabelVector.setVisible(true);
        }      
      });

      $('#psHmapChk2').on('click', function () {
        if (!$('#psHmapChk2').is(':checked')) {                    
          $('.hmapDiv2').hide();
        } else {                    
          $('.hmapDiv2').show();
        }      
      });

      $('#psHmapChk3').on('click', function () {
        if (!$('#psHmapChk3').is(':checked')) {                    
          $('.hmapDiv3').hide();
        } else {      
          $('.hmapDiv3').show();
        }      
      });

      /*
      $('#chkTest2').on('click', function () {
        if (roadPOIVector2.getVisible()) {
          roadPOIVector2.setVisible(false);
          $('.hmapDiv2').hide();
        } else {
          roadPOIVector2.setVisible(true);
          $('.hmapDiv2').show();
        }      
      });

      $('#chkTest3').on('click', function () {
        if (roadPOIVector2.getVisible()) {
          roadPOIVector2.setVisible(false);
          $('.hmapDiv3').hide();
        } else {
          roadPOIVector2.setVisible(true);
          $('.hmapDiv3').show();
        }      
      });
*/

  // $.ajax({
  //   dataType: 'json',
  //   url: 'http://info.rlog.kr:8880/rest/shp2Geojson/jeonju_road_poi_all',
  //   type: 'GET',
  //   async: true,
  //   beforeSend: function () {
  //     $('#div_load_image').show();
  //   },
  //   success: function (result) {
  //     console.log(result);
  //     $('#div_load_image').hide();

  //     var roadPOISource2 = new ol.source.Vector({
  //       //features: (new ol.format.GeoJSON()).readFeatures(result),
  //       url: 'http://info.rlog.kr:8880/rest/shp2Geojson/jeonju_road_poi_all',
  //       projection: 'EPSG:3857',
  //       format: new ol.format.GeoJSON()
  //     });

  //     roadPOISource2.once('featuresloadstart', function (e) {console.log("roadAllPOISource2dsfdsfds11");
  //       if (roadPOISource2.getState() === 'ready') {
  //         console.log("roadAllPOISource2dsfdsfds");
         
  //       }
  //     });

  //     var roadPOIVector2 = new ol.layer.Vector({
  //       title: '도로 Point2',
  //       visible: true,
  //       source: roadPOISource2,
  //       style: new ol.style.Style({
  //         image: new ol.style.Circle({
  //           radius: 5,
  //           snapToPixel: false,
  //           stroke: new ol.style.Stroke({
  //             //color: "#6C757D",
  //             color: "#900",
  //             width: 2
  //           })
  //         })
  //       }),
  //       maxResolution: 25,
  //       zIndex: 1000
  //     });
  //     map.addLayer(roadPOIVector2);
      // $('#chkTest').on('click', function () {
      //   if (flowlineVector.getVisible()) {
      //     flowlineVector.setVisible(false);
      //   } else {
      //     flowlineVector.setVisible(true);
      //   }
      //   // var isLayer = false;
      //   // map.getAllLayers().forEach(function(p) {
      //   //   //console.log(p.get('title'));
      //   //   if(p.get('title') == '도로 점수') {
      //   //     isLayer = true;
      //   //   }
      //   // });
      //   // if(!isLayer){
      //   //   map.addLayer(flowlineVector);
      //   // } else {
      //   //   map.removeLayer(flowlineVector);
      //   // }
      // });
  //   },
  //   error: function (request, status, error) {
  //     alert("REST API로부터 데이터를 받아올 수 없습니다.");
  //   }
  // });


</script>