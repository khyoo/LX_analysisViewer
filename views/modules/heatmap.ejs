<script type="text/javascript">

  var hmap_blur = document.getElementById('hmap_blur');
  var hmap_radius = document.getElementById('hmap_radius');

  var hmapVector = new ol.layer.Heatmap({
    visible: false,
    source: new ol.source.Vector({
      url: '/data/poi.geojson',
      //url: '/data/point_final_score_220610.geojson',
      format: new ol.format.GeoJSON()
    }),
    blur: parseInt(hmap_blur.value, 10),
    radius: parseInt(hmap_radius.value, 10)
  });

  hmapVector.getSource().on('addfeature', function (event) {
    // 2012_Earthquakes_Mag5.kml stores the magnitude of each earthquake in a
    // standards-violating <magnitude> tag in each Placemark.  We extract it from
    // the Placemark's name instead.        
    event.feature.set('weight', event.feature.getProperties().panoid.substring(8) / 100);
    //event.feature.set('weight', event.feature.getProperties().qt_score / 4);
  });

  hmap_blur.addEventListener('input', function () {
    hmapVector.setBlur(parseInt(hmap_blur.value, 10));
  });

  hmap_radius.addEventListener('input', function () {
    hmapVector.setRadius(parseInt(hmap_radius.value, 10));
  });

</script>